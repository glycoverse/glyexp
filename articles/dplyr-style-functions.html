<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>dplyr-Style Functions: Data Harmony in Action • glyexp</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="dplyr-Style Functions: Data Harmony in Action">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyexp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/glyexp.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/create-exp.html">Creating Experiments</a></li>
    <li><a class="dropdown-item" href="../articles/dplyr-style-functions.html">dplyr-Style Functions: Data Harmony in Action</a></li>
    <li><a class="dropdown-item" href="../articles/exp-type.html">Experiment Types</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>dplyr-Style Functions: Data Harmony in Action</h1>
            
      

      <div class="d-none name"><code>dplyr-style-functions.Rmd</code></div>
    </div>

    
    
<p>Welcome to the world of <strong>synchronized data
manipulation</strong>! 🎼</p>
<p>If you’ve ever worked with multi-table datasets, you know the pain:
filter one table, and suddenly your data is out of sync. Rearrange
another, and your carefully crafted relationships crumble like a house
of cards.</p>
<p><strong>Enter glyexp’s dplyr-style functions</strong> - your new data
harmony conductors! 🎯</p>
<p>These aren’t just regular dplyr functions with a fancy wrapper.
They’re <strong>relationship-aware data manipulators</strong>
specifically designed for <code><a href="../reference/experiment.html">glyexp::experiment()</a></code> objects that
understand the intricate dance between your expression matrix, sample
information, and variable annotations. When you transform one piece,
everything else follows in perfect synchronization.</p>
<p><strong>🎯 Important Note:</strong> These functions <strong>only work
with <code><a href="../reference/experiment.html">experiment()</a></code> objects</strong> - you cannot use them on
regular data.frames, tibbles, or other data structures. They are
purpose-built for the synchronized data model that
<code><a href="../reference/experiment.html">experiment()</a></code> provides.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://glycoverse.github.io/glyexp/">glyexp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:glyexp':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     select_var</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://conflicted.r-lib.org/" class="external-link">conflicted</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html" class="external-link">conflicts_prefer</a></span><span class="op">(</span><span class="fu">glyexp</span><span class="fu">::</span><span class="va"><a href="../reference/select_obs.html">select_var</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">[conflicted]</span> Will prefer <span style="color: #0000BB; font-weight: bold;">glyexp</span>::select_var over</span></span>
<span><span class="co">#&gt; any other package.</span></span>
<span><span class="fu"><a href="https://conflicted.r-lib.org/reference/conflicts_prefer.html" class="external-link">conflicts_prefer</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">[conflicted]</span> Will prefer <span style="color: #0000BB; font-weight: bold;">dplyr</span>::filter over any</span></span>
<span><span class="co">#&gt; other package.</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-core-philosophy-one-action-three-updates">The Core Philosophy: One Action, Three Updates 🎭<a class="anchor" aria-label="anchor" href="#the-core-philosophy-one-action-three-updates"></a>
</h2>
<p>Imagine you’re the conductor of a three-piece orchestra:</p>
<p>🎼 <strong>First violin (Expression Matrix)</strong>: Your numerical
data<br>
🎼 <strong>Second violin (Sample Info)</strong>: Your experimental
metadata<br>
🎼 <strong>Viola (Variable Info)</strong>: Your molecular
annotations</p>
<p>In traditional data analysis, when you want the first violin to play
a solo (filter samples), you have to manually cue each instrument. Miss
a beat, and your symphony turns into chaos.</p>
<p><strong>glyexp’s dplyr-style functions are different.</strong>
They’re like having a magical conductor’s baton - wave it once, and all
three instruments respond in perfect harmony!</p>
<p>Let’s see this magic in action:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">toy_exp</span> <span class="op">&lt;-</span> <span class="va">toy_experiment</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">toy_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Others Experiment</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">6</span> samples, <span style="color: #0000BB;">4</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">batch</span> <span style="color: #0000BB;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">peptide</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-two-flavors-_obs-and-_var">The Two Flavors: <code>_obs()</code> and <code>_var()</code> 🍦<a class="anchor" aria-label="anchor" href="#the-two-flavors-_obs-and-_var"></a>
</h2>
<p>Every dplyr-style function in glyexp comes in two delicious
flavors:</p>
<ul>
<li>
<strong><code>_obs()</code> functions</strong>: Work on sample
information (observations/columns) in <code><a href="../reference/experiment.html">experiment()</a></code>
objects</li>
<li>
<strong><code>_var()</code> functions</strong>: Work on variable
annotations (variables/rows) in <code><a href="../reference/experiment.html">experiment()</a></code> objects</li>
</ul>
<p>But here’s the beautiful part - <strong>both flavors automatically
update the expression matrix</strong> to maintain perfect
synchronization!</p>
<p><strong>⚠️ Reminder:</strong> These specialized functions require an
<code><a href="../reference/experiment.html">experiment()</a></code> object as input and return an
<code><a href="../reference/experiment.html">experiment()</a></code> object as output. They cannot be used with
standard tibbles or data.frames - for those, use the regular dplyr
functions directly.</p>
<div class="section level3">
<h3 id="filtering-the-art-of-selective-attention">Filtering: The Art of Selective Attention 🔍<a class="anchor" aria-label="anchor" href="#filtering-the-art-of-selective-attention"></a>
</h3>
<p>Let’s start with the most common operation - filtering your data.</p>
<div class="section level4">
<h4 id="sample-based-filtering-with-filter_obs">Sample-Based Filtering with <code>filter_obs()</code><a class="anchor" aria-label="anchor" href="#sample-based-filtering-with-filter_obs"></a>
</h4>
<p>Say you want to focus only on group “A” samples:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Before filtering - let's see what we have</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">toy_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for group A samples only</span></span>
<span><span class="va">filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1</span></span></code></pre></div>
<p><strong>Beautiful!</strong> But here’s where the magic happens -
check the expression matrix:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Original matrix dimensions:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">toy_exp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 6</span></span>
<span></span>
<span><span class="co"># Original matrix:</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">toy_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3 S4 S5 S6</span></span>
<span><span class="co">#&gt; V1  1  5  9 13 17 21</span></span>
<span><span class="co">#&gt; V2  2  6 10 14 18 22</span></span>
<span><span class="co">#&gt; V3  3  7 11 15 19 23</span></span>
<span><span class="co">#&gt; V4  4  8 12 16 20 24</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filtered expression matrix - automatically updated!</span></span>
<span></span>
<span><span class="co"># Filtered matrix dimensions:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 4 3</span></span>
<span></span>
<span><span class="co"># Filtered matrix:</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3</span></span>
<span><span class="co">#&gt; V1  1  5  9</span></span>
<span><span class="co">#&gt; V2  2  6 10</span></span>
<span><span class="co">#&gt; V3  3  7 11</span></span>
<span><span class="co">#&gt; V4  4  8 12</span></span></code></pre></div>
<p>🎪 <strong>Ta-da!</strong> The expression matrix automatically
filtered its columns to match the remaining samples! No manual
intervention, no risk of mismatched data - just pure, synchronized
harmony.</p>
</div>
<div class="section level4">
<h4 id="variable-based-filtering-with-filter_var">Variable-Based Filtering with <code>filter_var()</code><a class="anchor" aria-label="anchor" href="#variable-based-filtering-with-filter_var"></a>
</h4>
<p>Now let’s filter variables and watch the same magic happen:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter for specific glycan compositions</span></span>
<span><span class="va">var_filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">glycan_composition</span> <span class="op">==</span> <span class="st">"H5N2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">var_filtered_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 4</span></span></span>
<span><span class="co">#&gt;   variable protein peptide glycan_composition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V1       PRO1    PEP1    H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V2       PRO2    PEP2    H5N2</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># The expression matrix rows automatically follow suit!</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">var_filtered_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3 S4 S5 S6</span></span>
<span><span class="co">#&gt; V1  1  5  9 13 17 21</span></span>
<span><span class="co">#&gt; V2  2  6 10 14 18 22</span></span></code></pre></div>
<p><strong>The matrix rows automatically reduced to match the filtered
variables!</strong> This is the core power of glyexp - you think about
your metadata, and the expression data follows your lead.</p>
</div>
<div class="section level4">
<h4 id="chaining-filters-the-symphony-continues">Chaining Filters: The Symphony Continues 🎵<a class="anchor" aria-label="anchor" href="#chaining-filters-the-symphony-continues"></a>
</h4>
<p>Want to filter both samples and variables? Chain them together like a
beautiful melody:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">double_filtered</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_var</a></span><span class="op">(</span><span class="va">glycan_composition</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H5N2"</span>, <span class="st">"N3N2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Final dimensions after double filtering:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">double_filtered</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">double_filtered</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2 S3</span></span>
<span><span class="co">#&gt; V1  1  5  9</span></span>
<span><span class="co">#&gt; V2  2  6 10</span></span></code></pre></div>
<p><strong>Notice the pipe-friendly design?</strong> That’s the dplyr
DNA in action - familiar syntax, powerful results!</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="the-sacred-index-columns-guardians-of-data-integrity">The Sacred Index Columns: Guardians of Data Integrity 🛡️<a class="anchor" aria-label="anchor" href="#the-sacred-index-columns-guardians-of-data-integrity"></a>
</h2>
<p>Here’s where glyexp really shines: <strong>index column
protection</strong>. These special columns (like “sample” and
“variable”) are the backbone of your data relationships. Lose them, and
your carefully orchestrated data symphony falls apart.</p>
<p>Let’s see this protection in action:</p>
<div class="section level3">
<h3 id="attempting-to-remove-index-columns-spoiler-it-wont-work">Attempting to Remove Index Columns (Spoiler: It Won’t Work!) 😄<a class="anchor" aria-label="anchor" href="#attempting-to-remove-index-columns-spoiler-it-wont-work"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Try to select everything EXCEPT the sample index column</span></span>
<span><span class="va">protective_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="op">-</span><span class="va">sample</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You should not explicitly select or deselect the <span style="color: #0000BB;">"sample"</span> column in</span></span>
<span><span class="co">#&gt;   `sample_info`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The <span style="color: #0000BB;">"sample"</span> column will be handled by `select_obs()` or `select_var()`</span></span>
<span><span class="co">#&gt;   automatically.</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">protective_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: object 'protective_exp' not found</span></span></code></pre></div>
<p><strong>Did you see that error message?</strong> glyexp throws a
helpful error message and protects our data integrity by preventing this
operation entirely!</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Same protection for variable info</span></span>
<span><span class="va">protective_var_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="op">-</span><span class="va">variable</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You should not explicitly select or deselect the <span style="color: #0000BB;">"variable"</span> column in</span></span>
<span><span class="co">#&gt;   `var_info`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The <span style="color: #0000BB;">"variable"</span> column will be handled by `select_obs()` or `select_var()`</span></span>
<span><span class="co">#&gt;   automatically.</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">protective_var_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: object 'protective_var_exp' not found</span></span></code></pre></div>
<p>Similarly, glyexp throws an error to protect the “variable” column
from being removed! 🏰</p>
</div>
<div class="section level3">
<h3 id="why-this-protection-matters">Why This Protection Matters<a class="anchor" aria-label="anchor" href="#why-this-protection-matters"></a>
</h3>
<p>Without index columns, your <code><a href="../reference/experiment.html">experiment()</a></code> object would
lose its ability to:</p>
<ul>
<li>✅ Keep expression matrix and metadata synchronized</li>
<li>✅ Validate data consistency</li>
<li>✅ Enable seamless subsetting operations</li>
<li>✅ Work with other <code>glycoverse</code> packages</li>
</ul>
<p>Think of index columns as the <strong>GPS coordinates</strong> of
your data - remove them, and you’re lost in a sea of unconnected
numbers!</p>
</div>
</div>
<div class="section level2">
<h2 id="the-complete-function-family-tree">The Complete Function Family Tree 🌳<a class="anchor" aria-label="anchor" href="#the-complete-function-family-tree"></a>
</h2>
<p>glyexp provides dplyr-style equivalents for all your favorite data
manipulation functions. <strong>Each function comes in both
<code>_obs()</code> and <code>_var()</code> flavors</strong>, and
<strong>all automatically maintain matrix synchronization</strong>.</p>
<p><strong>🔧 Technical Note:</strong> All these functions are
<strong>methods specifically for <code><a href="../reference/experiment.html">experiment()</a></code>
objects</strong>. Unlike generic dplyr functions that work on various
data types, these functions expect and return <code><a href="../reference/experiment.html">experiment()</a></code>
objects exclusively:</p>
<div class="section level3">
<h3 id="core-data-manipulation-functions">Core Data Manipulation Functions<a class="anchor" aria-label="anchor" href="#core-data-manipulation-functions"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">Standard dplyr</th>
<th align="left">Sample Operations</th>
<th align="left">Variable Operations</th>
<th align="left">Magic Power</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter()</a></code></td>
<td align="left"><code><a href="../reference/filter_obs.html">filter_obs()</a></code></td>
<td align="left"><code><a href="../reference/filter_obs.html">filter_var()</a></code></td>
<td align="left">🔍 Subset with sync</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select()</a></code></td>
<td align="left"><code><a href="../reference/select_obs.html">select_obs()</a></code></td>
<td align="left"><code><a href="../reference/select_obs.html">select_var()</a></code></td>
<td align="left">🎯 Choose with protection</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange()</a></code></td>
<td align="left"><code><a href="../reference/arrange_obs.html">arrange_obs()</a></code></td>
<td align="left"><code><a href="../reference/arrange_obs.html">arrange_var()</a></code></td>
<td align="left">📊 Sort with order</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate()</a></code></td>
<td align="left"><code><a href="../reference/mutate_obs.html">mutate_obs()</a></code></td>
<td align="left"><code><a href="../reference/mutate_obs.html">mutate_var()</a></code></td>
<td align="left">➕ Create with consistency</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename()</a></code></td>
<td align="left"><code><a href="../reference/rename_obs.html">rename_obs()</a></code></td>
<td align="left"><code><a href="../reference/rename_obs.html">rename_var()</a></code></td>
<td align="left">🏷️ Rename with safety</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="advanced-slicing-functions">Advanced Slicing Functions<a class="anchor" aria-label="anchor" href="#advanced-slicing-functions"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">Standard dplyr</th>
<th align="left">Sample Operations</th>
<th align="left">Variable Operations</th>
<th align="left">Specialty</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_var()</a></code></td>
<td align="left">🔢 Position-based selection</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_head()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_head_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_head_var()</a></code></td>
<td align="left">⬆️ Top n with sync</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_tail_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_tail_var()</a></code></td>
<td align="left">⬇️ Bottom n with sync</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_sample()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_sample_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_sample_var()</a></code></td>
<td align="left">🎲 Random with consistency</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_max_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_max_var()</a></code></td>
<td align="left">📈 Highest values with order</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_min()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_min_obs()</a></code></td>
<td align="left"><code><a href="../reference/slice_obs.html">slice_min_var()</a></code></td>
<td align="left">📉 Lowest values with order</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="joining-functions">Joining Functions<a class="anchor" aria-label="anchor" href="#joining-functions"></a>
</h3>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th align="left">Standard dplyr</th>
<th align="left">Sample Operations</th>
<th align="left">Variable Operations</th>
<th align="left">Magic Power</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">left_join_obs()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">left_join_var()</a></code></td>
<td align="left">Add new columns from another table (left join)</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">inner_join_obs()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">inner_join_var()</a></code></td>
<td align="left">Add new columns from another table (inner join)</td>
</tr>
<tr class="odd">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">semi_join()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">semi_join_obs()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">semi_join_var()</a></code></td>
<td align="left">Filter rows from another table (semi join)</td>
</tr>
<tr class="even">
<td align="left"><code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">anti_join_obs()</a></code></td>
<td align="left"><code><a href="../reference/left_join_obs.html">anti_join_var()</a></code></td>
<td align="left">Filter rows from another table (anti join)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="deep-dive-function-by-function-examples">Deep Dive: Function-by-Function Examples 🏊‍♂️<a class="anchor" aria-label="anchor" href="#deep-dive-function-by-function-examples"></a>
</h2>
<p>Let’s explore each function family with hands-on examples!</p>
<div class="section level3">
<h3 id="selection-choosing-your-data-wisely">Selection: Choosing Your Data Wisely 🎯<a class="anchor" aria-label="anchor" href="#selection-choosing-your-data-wisely"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select specific columns from sample info</span></span>
<span><span class="va">selected_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">group</span>, <span class="va">batch</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">selected_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select columns from variable info (notice the index protection!)</span></span>
<span><span class="va">var_selected_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">glycan_composition</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">var_selected_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   variable glycan_composition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V1       H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V2       H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V3       H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> V4       H3N2</span></span></code></pre></div>
<p><strong>Pro tip:</strong> Use <code>dplyr</code>-style helpers like
<code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with()</a></code>, and
<code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains()</a></code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select columns starting with "glycan"</span></span>
<span><span class="va">helper_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"glycan"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">helper_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 2</span></span></span>
<span><span class="co">#&gt;   variable glycan_composition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V1       H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V2       H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V3       H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> V4       H3N2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="arrangement-putting-things-in-order">Arrangement: Putting Things in Order 📊<a class="anchor" aria-label="anchor" href="#arrangement-putting-things-in-order"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arrange samples by batch and group</span></span>
<span><span class="va">arranged_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arrange_obs.html">arrange_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">batch</span>, <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">arranged_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S3     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S5     B         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S4     B         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2</span></span></code></pre></div>
<p><strong>The magic moment:</strong> Check how the expression matrix
columns rearranged to match!</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expression matrix columns follow the new sample order</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">arranged_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S3 S5 S2 S4 S6</span></span>
<span><span class="co">#&gt; V1  1  9 17  5 13 21</span></span>
<span><span class="co">#&gt; V2  2 10 18  6 14 22</span></span>
<span><span class="co">#&gt; V3  3 11 19  7 15 23</span></span>
<span><span class="co">#&gt; V4  4 12 20  8 16 24</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mutation-creating-new-insights">Mutation: Creating New Insights ➕<a class="anchor" aria-label="anchor" href="#mutation-creating-new-insights"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add a new calculated column to sample info</span></span>
<span><span class="va">mutated_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mutate_obs.html">mutate_obs</a></span><span class="op">(</span></span>
<span>  <span class="va">toy_exp</span>,</span>
<span>  group_batch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">batch</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">mutated_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   sample group batch group_batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1 A_1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2 A_2        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1 A_1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B         2 B_2        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B         1 B_1        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2 B_2</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a complexity score for variables</span></span>
<span><span class="va">complex_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mutate_obs.html">mutate_var</a></span><span class="op">(</span></span>
<span>  <span class="va">toy_exp</span>,</span>
<span>  complexity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">glycan_composition</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">complex_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   variable protein peptide glycan_composition complexity</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V1       PRO1    PEP1    H5N2                        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V2       PRO2    PEP2    H5N2                        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V3       PRO3    PEP3    H3N2                        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> V4       PRO3    PEP4    H3N2                        4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="slicing-precision-subsetting">Slicing: Precision Subsetting 🔢<a class="anchor" aria-label="anchor" href="#slicing-precision-subsetting"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Take the first 2 samples</span></span>
<span><span class="va">head_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slice_obs.html">slice_head_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">head_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Expression matrix automatically adjusts</span></span>
<span><span class="fu"><a href="../reference/get_expr_mat.html">get_expr_mat</a></span><span class="op">(</span><span class="va">head_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt;    S1 S2</span></span>
<span><span class="co">#&gt; V1  1  5</span></span>
<span><span class="co">#&gt; V2  2  6</span></span>
<span><span class="co">#&gt; V3  3  7</span></span>
<span><span class="co">#&gt; V4  4  8</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sample randomly from variables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># For reproducibility</span></span>
<span><span class="va">random_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slice_obs.html">slice_sample_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">random_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   variable protein peptide glycan_composition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V3       PRO3    PEP3    H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V4       PRO3    PEP4    H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V1       PRO1    PEP1    H5N2</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="renaming-clarity-through-better-names">Renaming: Clarity Through Better Names 🏷️<a class="anchor" aria-label="anchor" href="#renaming-clarity-through-better-names"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename columns in sample info</span></span>
<span><span class="va">renamed_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rename_obs.html">rename_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, experimental_group <span class="op">=</span> <span class="va">group</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">renamed_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sample experimental_group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A                      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B                      2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B                      1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B                      2</span></span></code></pre></div>
<p><strong>Notice:</strong> The index column “sample” remains
untouchable, but everything else can be renamed freely!</p>
</div>
<div class="section level3">
<h3 id="joining-bridging-tables-together">Joining: Bridging Tables Together 🔗<a class="anchor" aria-label="anchor" href="#joining-bridging-tables-together"></a>
</h3>
<p>These functions can be useful if you have additional information
stored in a separate tibble, and you want to add it to your
<code><a href="../reference/experiment.html">experiment()</a></code> object.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Join sample info with variable info</span></span>
<span><span class="va">more_sample_info</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>, <span class="st">"S5"</span>, <span class="st">"S6"</span><span class="op">)</span>,</span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>, <span class="fl">23</span>, <span class="fl">24</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>  gender <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">joined_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/left_join_obs.html">left_join_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">more_sample_info</span>, by <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">joined_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   sample group batch   age gender</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1    20 M     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2    21 F     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1    22 M     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B         2    23 F     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B         1    24 M     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2    25 F</span></span></code></pre></div>
<p>You might have noticed that we don’t have alternatives for
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::right_join()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::full_join()</a></code>.
This is because by design joining functions in <code>glyexp</code>
should only be used to add new information to your
<code><a href="../reference/experiment.html">experiment()</a></code> object. However, <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">right_join()</a></code> and
<code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join()</a></code> will add more observations to the resulting
tibbles, which is not suitable for <code><a href="../reference/experiment.html">experiment()</a></code>
objects.</p>
<p>For the same reason, the <code>relationship</code> parameter is fixed
to “many-to-one” for all joining functions in <code>glyexp</code>. You
probably don’t need to know this, but if you do, check out the
documentation of <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">dplyr::left_join()</a></code> for more details.</p>
</div>
</div>
<div class="section level2">
<h2 id="advanced-patterns-chaining-for-complex-operations">Advanced Patterns: Chaining for Complex Operations 🔗<a class="anchor" aria-label="anchor" href="#advanced-patterns-chaining-for-complex-operations"></a>
</h2>
<p>The real power emerges when you chain multiple operations together.
Here are some advanced patterns:</p>
<div class="section level3">
<h3 id="pattern-1-filter-select-arrange">Pattern 1: Filter → Select → Arrange<a class="anchor" aria-label="anchor" href="#pattern-1-filter-select-arrange"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_pipeline</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">group</span>, <span class="va">batch</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/arrange_obs.html">arrange_obs</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">batch</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_var</a></span><span class="op">(</span><span class="va">protein</span> <span class="op">==</span> <span class="st">"PRO1"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_obs.html">select_var</a></span><span class="op">(</span><span class="va">glycan_composition</span>, <span class="va">protein</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Final pipeline result:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Final pipeline result:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">complex_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Others Experiment</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">3</span> samples, <span style="color: #0000BB;">1</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">batch</span> <span style="color: #0000BB;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pattern-2-mutate-filter-slice">Pattern 2: Mutate → Filter → Slice<a class="anchor" aria-label="anchor" href="#pattern-2-mutate-filter-slice"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">analytical_pipeline</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/mutate_obs.html">mutate_var</a></span><span class="op">(</span>composition_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">glycan_composition</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_var</a></span><span class="op">(</span><span class="va">composition_length</span> <span class="op">&gt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/slice_obs.html">slice_max_var</a></span><span class="op">(</span><span class="va">composition_length</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">analytical_pipeline</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   variable protein peptide glycan_composition composition_length</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V1       PRO1    PEP1    H5N2                                4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V2       PRO2    PEP2    H5N2                                4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V3       PRO3    PEP3    H3N2                                4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> V4       PRO3    PEP4    H3N2                                4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pattern-3-random-sampling-for-testing">Pattern 3: Random Sampling for Testing<a class="anchor" aria-label="anchor" href="#pattern-3-random-sampling-for-testing"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a smaller dataset for testing</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">test_exp</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/slice_obs.html">slice_sample_obs</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/slice_obs.html">slice_sample_var</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Test dataset dimensions:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Test dataset dimensions:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">test_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Others Experiment</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">3</span> samples, <span style="color: #0000BB;">4</span> variables</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">batch</span> <span style="color: #0000BB;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">protein</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">peptide</span> <span style="color: #0000BB;">&lt;chr&gt;</span>, <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;chr&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="when-dplyr-style-functions-cant-help-the-escape-hatch">When dplyr-Style Functions Can’t Help: The Escape Hatch 🚪<a class="anchor" aria-label="anchor" href="#when-dplyr-style-functions-cant-help-the-escape-hatch"></a>
</h2>
<p>Sometimes you need functionality that goes beyond what glyexp’s
dplyr-style functions provide. <strong>No problem!</strong> Since
glyexp’s dplyr-style functions <strong>only work with
<code><a href="../reference/experiment.html">experiment()</a></code> objects</strong>, when you need standard dplyr
functionality, simply extract the tibbles and use any dplyr function you
want.</p>
<div class="section level3">
<h3 id="why-doesnt-glyexp-implement-all-dplyr-functions">Why Doesn’t glyexp Implement All dplyr Functions? 🤔<a class="anchor" aria-label="anchor" href="#why-doesnt-glyexp-implement-all-dplyr-functions"></a>
</h3>
<p><strong>The philosophy is simple:</strong> glyexp only implements
functions that <strong>preserve the synchronized multi-table
structure</strong> of <code><a href="../reference/experiment.html">experiment()</a></code> objects.</p>
<p>Functions like <code><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct()</a></code>,
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise()</a></code>, and <code><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull()</a></code> return aggregated
results that break the original data relationships. For these
operations, extract the relevant tibble and use standard dplyr
functions:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For complex aggregations</span></span>
<span><span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;   group     n</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B         3</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For distinct values</span></span>
<span><span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">protein</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PRO1" "PRO2" "PRO3"</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># For advanced filtering with multiple conditions</span></span>
<span><span class="va">complex_filter_conditions</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="va">batch</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Then use the results to subset your experiment</span></span>
<span><span class="va">filtered_by_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">sample</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">complex_filter_conditions</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="common-pitfalls-and-how-to-avoid-them">Common Pitfalls and How to Avoid Them ⚠️<a class="anchor" aria-label="anchor" href="#common-pitfalls-and-how-to-avoid-them"></a>
</h2>
<div class="section level3">
<h3 id="pitfall-1-using-glyexp-functions-on-non-experiment-objects">Pitfall 1: Using glyexp Functions on Non-Experiment Objects<a class="anchor" aria-label="anchor" href="#pitfall-1-using-glyexp-functions-on-non-experiment-objects"></a>
</h3>
<p><strong>❌ This won’t work:</strong></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># glyexp functions only work on experiment() objects!</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="va">regular_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">regular_tibble</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span>  <span class="co"># Error: not an experiment object!</span></span>
<span><span class="co">#&gt; Error in filter_info_data(exp = exp, info_field = "sample_info", id_column = "sample", : is_experiment(exp) is not TRUE</span></span></code></pre></div>
<p><strong>✅ Do this instead:</strong></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use regular dplyr functions for regular data structures</span></span>
<span><span class="va">regular_tibble</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">regular_tibble</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span>  <span class="co"># Works perfectly!</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 2</span></span></span>
<span><span class="co">#&gt;   group value</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         1</span></span>
<span></span>
<span><span class="co"># Use glyexp functions only with experiment objects</span></span>
<span><span class="va">filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span>  <span class="co"># This works!</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">filtered_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pitfall-2-forgetting-the-synchronization-magic">Pitfall 2: Forgetting the Synchronization Magic<a class="anchor" aria-label="anchor" href="#pitfall-2-forgetting-the-synchronization-magic"></a>
</h3>
<p><strong>❌ Don’t do this:</strong></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This breaks synchronization!</span></span>
<span><span class="va">sample_info</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">toy_exp</span><span class="op">)</span></span>
<span><span class="va">filtered_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_info</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="co"># Now you have filtered sample info but the original expression matrix!</span></span></code></pre></div>
<p><strong>✅ Do this instead:</strong></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This maintains synchronization</span></span>
<span><span class="va">filtered_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span></span>
<span><span class="co"># Everything stays in sync!</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pitfall-3-trying-to-remove-index-columns">Pitfall 3: Trying to Remove Index Columns<a class="anchor" aria-label="anchor" href="#pitfall-3-trying-to-remove-index-columns"></a>
</h3>
<p><strong>❌ This won’t work as expected:</strong></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Index column protection prevents this - will throw an error!</span></span>
<span><span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="op">-</span><span class="va">sample</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; <span style="color: #BBBB00; font-weight: bold;">Error</span><span style="font-weight: bold;">:</span></span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> You should not explicitly select or deselect the <span style="color: #0000BB;">"sample"</span> column in</span></span>
<span><span class="co">#&gt;   `sample_info`.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> The <span style="color: #0000BB;">"sample"</span> column will be handled by `select_obs()` or `select_var()`</span></span>
<span><span class="co">#&gt;   automatically.</span></span></code></pre></div>
<p><strong>✅ Embrace the protection:</strong></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Select the columns you want, let glyexp protect the index</span></span>
<span><span class="va">clean_exp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">group</span>, <span class="va">batch</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_sample_info.html">get_sample_info</a></span><span class="op">(</span><span class="va">clean_exp</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   sample group batch</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> S1     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> S2     A         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> S3     A         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> S4     B         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> S5     B         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> S6     B         2</span></span>
<span><span class="co"># "sample" column automatically included for data integrity</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pitfall-4-mismatched-operations">Pitfall 4: Mismatched Operations<a class="anchor" aria-label="anchor" href="#pitfall-4-mismatched-operations"></a>
</h3>
<p><strong>❌ Don’t mix operations inappropriately:</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This doesn't make sense - you can't arrange sample info by variable properties</span></span>
<span><span class="fu"><a href="../reference/arrange_obs.html">arrange_obs</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">glycan_composition</span><span class="op">)</span>  <span class="co"># glycan_composition is in var_info!</span></span></code></pre></div>
<p><strong>✅ Use the right function for the right data:</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Arrange variables by their glycan composition</span></span>
<span><span class="va">arranged_by_composition</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arrange_obs.html">arrange_var</a></span><span class="op">(</span><span class="va">toy_exp</span>, <span class="va">glycan_composition</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/get_var_info.html">get_var_info</a></span><span class="op">(</span><span class="va">arranged_by_composition</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 4</span></span></span>
<span><span class="co">#&gt;   variable protein peptide glycan_composition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> V3       PRO3    PEP3    H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> V4       PRO3    PEP4    H3N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> V1       PRO1    PEP1    H5N2              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> V2       PRO2    PEP2    H5N2</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="performance-considerations-speed-meets-safety">Performance Considerations: Speed Meets Safety 🏃‍♂️💨<a class="anchor" aria-label="anchor" href="#performance-considerations-speed-meets-safety"></a>
</h2>
<p>glyexp’s dplyr-style functions are designed to be:</p>
<p><strong>🚀 Fast</strong>: Built on top of highly optimized dplyr
functions<br><strong>🛡️ Safe</strong>: Index column protection prevents data
corruption<br><strong>🔄 Consistent</strong>: Automatic synchronization eliminates
manual errors</p>
<p>For large datasets, consider:</p>
<ul>
<li>Filtering early in your pipeline to reduce data size</li>
<li>Using <code><a href="../reference/select_obs.html">select_obs()</a></code> and <code><a href="../reference/select_obs.html">select_var()</a></code> to
keep only needed columns</li>
<li>Chaining operations efficiently to minimize intermediate copies</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Efficient pipeline: filter first, then manipulate</span></span>
<span><span class="va">efficient_pipeline</span> <span class="op">&lt;-</span> <span class="va">toy_exp</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_obs</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"A"</span><span class="op">)</span> <span class="op">|&gt;</span>          <span class="co"># Reduce samples early</span></span>
<span>  <span class="fu"><a href="../reference/filter_obs.html">filter_var</a></span><span class="op">(</span><span class="va">protein</span> <span class="op">==</span> <span class="st">"PRO1"</span><span class="op">)</span> <span class="op">|&gt;</span>     <span class="co"># Reduce variables early</span></span>
<span>  <span class="fu"><a href="../reference/select_obs.html">select_obs</a></span><span class="op">(</span><span class="va">group</span><span class="op">)</span> <span class="op">|&gt;</span>                 <span class="co"># Keep only needed sample columns</span></span>
<span>  <span class="fu"><a href="../reference/select_obs.html">select_var</a></span><span class="op">(</span><span class="va">glycan_composition</span><span class="op">)</span>       <span class="co"># Keep only needed variable columns</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-philosophy-behind-the-design">The Philosophy Behind the Design 🧠<a class="anchor" aria-label="anchor" href="#the-philosophy-behind-the-design"></a>
</h2>
<p>glyexp’s dplyr-style functions embody a simple but powerful
philosophy:</p>
<p><strong>“Think about your metadata, and let the data
follow.”</strong> 🎯</p>
<p>This design choice means:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Mental Model Alignment</strong>: You think in terms of
samples and variables, not matrix indices</li>
<li>
<strong>Error Prevention</strong>: Automatic synchronization
prevents the most common data analysis mistakes</li>
<li>
<strong>Familiar Syntax</strong>: If you know dplyr, you already
know 90% of glyexp</li>
<li>
<strong>Composability</strong>: Functions chain together naturally
for complex analyses</li>
</ol>
</div>
<div class="section level2">
<h2 id="summary">Summary 🎯<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>glyexp’s dplyr-style functions are <strong>experiment-specific data
manipulators</strong> designed exclusively for <code><a href="../reference/experiment.html">experiment()</a></code>
objects. They provide four key capabilities:</p>
<p>🎼 <strong>Automatic Synchronization</strong> - Operations on
metadata automatically update the expression matrix<br>
🛡️ <strong>Index Column Protection</strong> - Critical relationship
columns are protected from deletion<br>
🔗 <strong>Familiar Syntax</strong> - Standard dplyr operations with
multi-table awareness<br>
🎯 <strong>Type-Aware Operations</strong> - <code>_obs()</code> for
samples, <code>_var()</code> for variables</p>
<p><strong>Start simple with <code><a href="../reference/filter_obs.html">filter_obs()</a></code> and
<code><a href="../reference/select_obs.html">select_var()</a></code>, then build complex pipelines!</strong> 🎵</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
