# glyexp

Provides a tidy data framework for managing glycoproteomics and
glycomics experimental data. The core feature is the â€˜experiment()â€™
class, which serves as a unified data container integrating expression
matrices, variable information (proteins, peptides, glycan compositions,
etc.), and sample metadata (groups, batches, clinical variables, etc.).
The package enforces data consistency, validates column types according
to experiment types (glycomics, glycoproteomics, traitomics,
traitproteomics), and provides dplyr-style data manipulation functions
(filter, mutate, select, arrange, slice, join) for seamless data
wrangling.

## Installation

You can install the latest release of glyexp from CRAN with:

``` r
install.packages("glyexp")
```

Or install the development version from GitHub:

``` r
remotes::install_github("glycoverse/glyexp")
```

## Documentation

- ðŸš€ Get started:
  [Here](https://glycoverse.github.io/glyexp/articles/glyexp.html)
- ðŸ”§ dplyr-style data manipulation:
  [Here](https://glycoverse.github.io/glyexp/articles/dplyr-style-functions.html)
- ðŸ“š Reference:
  [Here](https://glycoverse.github.io/glyexp/reference/index.html)

## Role in `glycoverse`

The
[`experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
class provides a consistent interface for glycoprotemics and glycomics
data. All other packages in the `glycoverse` ecosystem know how to
extract information from an
[`experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
object. So, put your data in an
[`experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
object and pass it around. Let other packages do the heavy lifting.

## Example

``` r
library(glyexp)
library(magrittr)

# Create a toy experiment
a_little_toy <- toy_experiment
a_little_toy
#> 
#> â”€â”€ Others Experiment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#> â„¹ Expression matrix: 6 samples, 4 variables
#> â„¹ Sample information fields: group <chr>, batch <dbl>
#> â„¹ Variable information fields: protein <chr>, peptide <chr>, glycan_composition <chr>
```

``` r
get_expr_mat(a_little_toy)
#>    S1 S2 S3 S4 S5 S6
#> V1  1  5  9 13 17 21
#> V2  2  6 10 14 18 22
#> V3  3  7 11 15 19 23
#> V4  4  8 12 16 20 24
```

``` r
get_sample_info(a_little_toy)
#> # A tibble: 6 Ã— 3
#>   sample group batch
#>   <chr>  <chr> <dbl>
#> 1 S1     A         1
#> 2 S2     A         2
#> 3 S3     A         1
#> 4 S4     B         2
#> 5 S5     B         1
#> 6 S6     B         2
```

``` r
get_var_info(a_little_toy)
#> # A tibble: 4 Ã— 4
#>   variable protein peptide glycan_composition
#>   <chr>    <chr>   <chr>   <chr>             
#> 1 V1       PRO1    PEP1    H5N2              
#> 2 V2       PRO2    PEP2    H5N2              
#> 3 V3       PRO3    PEP3    H3N2              
#> 4 V4       PRO3    PEP4    H3N2
```

``` r
# Filter samples
a_little_toy %>% 
  filter_obs(group == "A") %>%
  filter_var(protein == "PRO1")
#> 
#> â”€â”€ Others Experiment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#> â„¹ Expression matrix: 3 samples, 1 variables
#> â„¹ Sample information fields: group <chr>, batch <dbl>
#> â„¹ Variable information fields: protein <chr>, peptide <chr>, glycan_composition <chr>
```

# Package index

## Experiment Creation and Conversion

- [`experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
  [`is_experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
  : Create a new experiment
- [`as_se()`](https://glycoverse.github.io/glyexp/reference/as_se.md) :
  Convert experiment to SummarizedExperiment
- [`from_se()`](https://glycoverse.github.io/glyexp/reference/from_se.md)
  : Convert SummarizedExperiment to experiment
- [`as_tibble(`*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/as_tibble.glyexp_experiment.md)
  : Convert an experiment to a tibble

## Experiment Inspection

- [`experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
  [`is_experiment()`](https://glycoverse.github.io/glyexp/reference/experiment.md)
  : Create a new experiment
- [`get_expr_mat()`](https://glycoverse.github.io/glyexp/reference/get_expr_mat.md)
  : Get the expression matrix of an experiment
- [`get_sample_info()`](https://glycoverse.github.io/glyexp/reference/get_sample_info.md)
  : Get the sample information of an experiment
- [`get_var_info()`](https://glycoverse.github.io/glyexp/reference/get_var_info.md)
  : Get the variable information of an experiment
- [`get_meta_data()`](https://glycoverse.github.io/glyexp/reference/get_meta_data.md)
  [`get_exp_type()`](https://glycoverse.github.io/glyexp/reference/get_meta_data.md)
  [`get_glycan_type()`](https://glycoverse.github.io/glyexp/reference/get_meta_data.md)
  : Get the meta data of an experiment
- [`count_compositions()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_structures()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_peptides()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_glycopeptides()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_glycoforms()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_proteins()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  [`count_glycosites()`](https://glycoverse.github.io/glyexp/reference/count_compositions.md)
  : Identification overview
- [`dim(`*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/dim.glyexp_experiment.md)
  [`` `dim<-`( ``*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/dim.glyexp_experiment.md)
  : Dimensions of an experiment
- [`dimnames(`*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/dimnames.glyexp_experiment.md)
  : Dimname for experiment
- [`n_samples()`](https://glycoverse.github.io/glyexp/reference/n_samples.md)
  [`n_variables()`](https://glycoverse.github.io/glyexp/reference/n_samples.md)
  : Get number of samples or variables of an experiment
- [`samples()`](https://glycoverse.github.io/glyexp/reference/samples.md)
  [`variables()`](https://glycoverse.github.io/glyexp/reference/samples.md)
  : Get Samples or Variables of an Experiment

## Dplyr-Style Manipulation

- [`arrange_obs()`](https://glycoverse.github.io/glyexp/reference/arrange_obs.md)
  [`arrange_var()`](https://glycoverse.github.io/glyexp/reference/arrange_obs.md)
  : Arrange sample or variable information
- [`filter_obs()`](https://glycoverse.github.io/glyexp/reference/filter_obs.md)
  [`filter_var()`](https://glycoverse.github.io/glyexp/reference/filter_obs.md)
  : Filter samples or variables of an experiment
- [`left_join_obs()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`inner_join_obs()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`semi_join_obs()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`anti_join_obs()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`left_join_var()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`inner_join_var()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`semi_join_var()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  [`anti_join_var()`](https://glycoverse.github.io/glyexp/reference/left_join_obs.md)
  : Join data to sample or variable information
- [`mutate_obs()`](https://glycoverse.github.io/glyexp/reference/mutate_obs.md)
  [`mutate_var()`](https://glycoverse.github.io/glyexp/reference/mutate_obs.md)
  : Mutate sample or variable information
- [`rename_obs()`](https://glycoverse.github.io/glyexp/reference/rename_obs.md)
  [`rename_var()`](https://glycoverse.github.io/glyexp/reference/rename_obs.md)
  : Rename columns in the sample or variable information tibble
- [`select_obs()`](https://glycoverse.github.io/glyexp/reference/select_obs.md)
  [`select_var()`](https://glycoverse.github.io/glyexp/reference/select_obs.md)
  : Select columns of the sample or variable information tibble
- [`slice_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_head_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_head_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_tail_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_tail_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_sample_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_sample_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_max_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_max_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_min_obs()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  [`slice_min_var()`](https://glycoverse.github.io/glyexp/reference/slice_obs.md)
  : Slice sample or variable information

## Base-Style Manipulation

- [`merge(`*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/merge.glyexp_experiment.md)
  : Merge two experiments
- [`split(`*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/split.glyexp_experiment.md)
  : Split an experiment
- [`` `[`( ``*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/sub-.glyexp_experiment.md)
  [`` `[<-`( ``*`<glyexp_experiment>`*`)`](https://glycoverse.github.io/glyexp/reference/sub-.glyexp_experiment.md)
  : Subsetting experiments

## Other Functions

- [`set_meta_data()`](https://glycoverse.github.io/glyexp/reference/set_meta_data.md)
  [`set_exp_type()`](https://glycoverse.github.io/glyexp/reference/set_meta_data.md)
  [`set_glycan_type()`](https://glycoverse.github.io/glyexp/reference/set_meta_data.md)
  : Set the meta data of an experiment

## Datasets

- [`toy_experiment`](https://glycoverse.github.io/glyexp/reference/toy_experiment.md)
  : Toy experiment
- [`real_experiment`](https://glycoverse.github.io/glyexp/reference/real_experiment.md)
  : Real glycoproteomics experiment
- [`real_experiment2`](https://glycoverse.github.io/glyexp/reference/real_experiment2.md)
  : Real glycomics experiment

# Articles

### All vignettes

- [Creating
  Experiments](https://glycoverse.github.io/glyexp/articles/create-exp.md):
- [dplyr-Style Functions: Data Harmony in
  Action](https://glycoverse.github.io/glyexp/articles/dplyr-style-functions.md):
- [Experiment
  Types](https://glycoverse.github.io/glyexp/articles/exp-type.md):
- [Get Started with
  glyexp](https://glycoverse.github.io/glyexp/articles/glyexp.md):
