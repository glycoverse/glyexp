<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a new experiment — experiment • glyexp</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a new experiment — experiment"><meta name="description" content="The data container of a glycoproteomics or glycomics experiment.
Expression matrix, sample information, and variable information
are required then will be managed by the experiment object.
It acts as the data core of the glycoverse ecosystem."><meta property="og:description" content="The data container of a glycoproteomics or glycomics experiment.
Expression matrix, sample information, and variable information
are required then will be managed by the experiment object.
It acts as the data core of the glycoverse ecosystem."><meta property="og:image" content="https://glycoverse.github.io/glyexp/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">glyexp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.11.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/glyexp.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/create-exp.html">Creating Experiments</a></li>
    <li><a class="dropdown-item" href="../articles/dplyr-style-functions.html">dplyr-Style Functions: Data Harmony in Action</a></li>
    <li><a class="dropdown-item" href="../articles/exp-type.html">Experiment Types</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glycoverse/glyexp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a new experiment</h1>
      <small class="dont-index">Source: <a href="https://github.com/glycoverse/glyexp/blob/v0.11.1/R/experiment.R" class="external-link"><code>R/experiment.R</code></a></small>
      <div class="d-none name"><code>experiment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The data container of a glycoproteomics or glycomics experiment.
Expression matrix, sample information, and variable information
are required then will be managed by the experiment object.
It acts as the data core of the <code>glycoverse</code> ecosystem.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">experiment</span><span class="op">(</span></span>
<span>  <span class="va">expr_mat</span>,</span>
<span>  sample_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_info <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  exp_type <span class="op">=</span> <span class="st">"others"</span>,</span>
<span>  glycan_type <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  coerce_col_types <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  check_col_types <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">is_experiment</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-expr-mat">expr_mat<a class="anchor" aria-label="anchor" href="#arg-expr-mat"></a></dt>
<dd><p>An expression matrix with samples as columns and variables as rows.</p></dd>


<dt id="arg-sample-info">sample_info<a class="anchor" aria-label="anchor" href="#arg-sample-info"></a></dt>
<dd><p>A tibble with a column named "sample", and other
columns other useful information about samples,
e.g. group, batch, sex, age, etc.
If NULL (default), a tibble with only one column named "sample" will be created,
same as the column names of <code>expr_mat</code>.</p></dd>


<dt id="arg-var-info">var_info<a class="anchor" aria-label="anchor" href="#arg-var-info"></a></dt>
<dd><p>A tibble with a column named "variable", and other
columns other useful information about variables,
e.g. protein name, peptide, glycan composition, etc.
If NULL (default), a tibble with only one column named "variable" will be created,
same as the row names of <code>expr_mat</code>.
Must be provided if <code>exp_type</code> is not "others".</p></dd>


<dt id="arg-exp-type">exp_type<a class="anchor" aria-label="anchor" href="#arg-exp-type"></a></dt>
<dd><p>The type of the experiment,
"glycomics", "glycoproteomics", "traitomics", "traitproteomics", or "others".
Default to "others".</p></dd>


<dt id="arg-glycan-type">glycan_type<a class="anchor" aria-label="anchor" href="#arg-glycan-type"></a></dt>
<dd><p>The type of glycan.
One of "N", "O-GalNAc", "O-GlcNAc", "O-Man", "O-Fuc", "O-Glc".
Can also be NULL if <code>exp_type</code> is "others".</p></dd>


<dt id="arg-coerce-col-types">coerce_col_types<a class="anchor" aria-label="anchor" href="#arg-coerce-col-types"></a></dt>
<dd><p>If common column types are coerced. Default to TRUE.
If TRUE, all columns in the "Column conventions" section will be coerced to the expected types.
Skipped for "others" type even if TRUE.</p></dd>


<dt id="arg-check-col-types">check_col_types<a class="anchor" aria-label="anchor" href="#arg-check-col-types"></a></dt>
<dd><p>If column type conventions are checked. Default to TRUE.
Type checking is performed after column coercion (if <code>coerce_col_types</code> is TRUE).
Skipped for "others" type even if TRUE.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other meta data about the experiment.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object to check.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>experiment()</code>. If the input data is wrong, an error will be raised.</p>
<p>A logical value.</p>
    </div>
    <div class="section level2">
    <h2 id="requirements-of-the-input-data">Requirements of the input data<a class="anchor" aria-label="anchor" href="#requirements-of-the-input-data"></a></h2>
    <p><strong>Expression matrix:</strong></p><ul><li><p>Must be a numeric matrix with <strong>variables as rows</strong> and <strong>samples as columns</strong>.</p></li>
<li><p>The <strong>column names</strong> must correspond to sample IDs.</p></li>
<li><p>The <strong>row names</strong> must correspond to variable IDs.</p></li>
</ul><p><strong>Sample information (<code>sample_info</code>):</strong></p><ul><li><p>Must be a tibble with a column named "sample" (sample ID).</p></li>
<li><p>Each value in "sample" must be unique.</p></li>
<li><p>The set of "sample" values must match the column names of the expression matrix (order does not matter).</p></li>
</ul><p><strong>Variable information (<code>var_info</code>):</strong></p><ul><li><p>Must be a tibble with a column named "variable" (variable ID).</p></li>
<li><p>Each value in "variable" must be unique.</p></li>
<li><p>The set of "variable" values must match the row names of the expression matrix (order does not matter).</p></li>
</ul><p>The function will automatically reorder the expression matrix
to match the order of "sample" and "variable" in the info tables.</p>
    </div>
    <div class="section level2">
    <h2 id="column-requirements">Column requirements<a class="anchor" aria-label="anchor" href="#column-requirements"></a></h2>
    <p>Some columns are required compulsorily in the variable information tibble for a valid experiment.
It depends on the experiment type.</p><ul><li><p>For "glycomics": <code>glycan_composition</code>.</p></li>
<li><p>For "glycoproteomics": <code>protein</code>, <code>protein_site</code>, <code>glycan_composition</code>.</p></li>
<li><p>For "traitomics": no required columns.</p></li>
<li><p>For "traitproteomics": <code>protein</code>, <code>protein_site</code>.</p></li>
<li><p>For "others": no required columns.</p></li>
</ul><p>See the "Column conventions" section for detailed description of these columns.</p>
<p>The last two types of experiments are created by the <code>glydet</code> package.
Normally you don't need to manually create them.</p>
    </div>
    <div class="section level2">
    <h2 id="column-conventions">Column conventions<a class="anchor" aria-label="anchor" href="#column-conventions"></a></h2>
    <p><code>glycoverse</code> has some conserved column names for <code>sample_info</code> and <code>var_info</code> to make everything work seamlessly.
It's not mandatory, but following these conventions will make your life easier.</p>
<p><strong>sample_info:</strong></p><ul><li><p><code>group</code>: factor, treatment/condition/grouping, used by many <code>glystats</code> and <code>glyvis</code> functions.</p></li>
<li><p><code>batch</code>: factor, batch information, used by <code>glyclean::correct_batch_effect()</code>.</p></li>
<li><p><code>bio_rep</code>: factor, biological replicate, may be used in the future.</p></li>
</ul><p><strong>var_info:</strong></p><ul><li><p><code>protein</code>: character, protein Uniprot accession.</p></li>
<li><p><code>protein_site</code>: integer, glycosylation site position on protein.</p></li>
<li><p><code>gene</code>: character, gene symbol.</p></li>
<li><p><code>peptide</code>: character, peptide sequence.</p></li>
<li><p><code>peptide_site</code>: integer, glycosylation site position on peptide.</p></li>
<li><p><code>glycan_composition</code>: <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_composition.html" class="external-link">glyrepr::glycan_composition()</a></code>, glycan composition.</p></li>
<li><p><code>glycan_structure</code>: <code><a href="https://glycoverse.github.io/glyrepr/reference/glycan_structure.html" class="external-link">glyrepr::glycan_structure()</a></code>, glycan structure.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="meta-data">Meta data<a class="anchor" aria-label="anchor" href="#meta-data"></a></h2>
    <p>Other meta data can be added to the <code>meta_data</code> attribute.
<code>meta_data</code> is a list of additional information about the experiment.
Two meta data fields are required:</p><ul><li><p><code>exp_type</code>: "glycomics", "glycoproteomics", "traitomics", "traitproteomics", or "others"</p></li>
<li><p><code>glycan_type</code>: "N", "O-GalNAc", "O-GlcNAc", "O-Man", "O-Fuc", "O-Glc", or NULL</p></li>
</ul><p>Other meta data will be added by other <code>glycoverse</code> packages for their own purposes.</p>
    </div>
    <div class="section level2">
    <h2 id="index-columns">Index columns<a class="anchor" aria-label="anchor" href="#index-columns"></a></h2>
    <p>The <strong>index columns</strong> are the backbone that keep your data synchronized:</p><ul><li><p>The "sample" column in <code>sample_info</code> must match the column names of <code>expr_mat</code>.</p></li>
<li><p>The "variable" column in <code>var_info</code> must match the row names of <code>expr_mat</code>.</p></li>
</ul><p>These columns act as unique identifiers,
ensuring that your expression matrix, sample information, and variable information always stay in sync,
no matter how you filter, arrange, or subset your data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># The minimum required input is an expression matrix.</span></span></span>
<span class="r-in"><span><span class="va">expr_mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">expr_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">expr_mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">experiment</span><span class="op">(</span><span class="va">expr_mat</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Others Experiment</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">3</span> samples, <span style="color: #0000BB;">3</span> variables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Sample information fields: none</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Variable information fields: none</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or with more detailed information.</span></span></span>
<span class="r-in"><span><span class="va">sample_info</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span><span class="op">)</span>, group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var_info</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V1"</span>, <span class="st">"V2"</span>, <span class="st">"V3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  glycan_composition <span class="op">=</span> <span class="fu">glyrepr</span><span class="fu">::</span><span class="fu"><a href="https://glycoverse.github.io/glyrepr/reference/glycan_composition.html" class="external-link">glycan_composition</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Hex <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">experiment</span><span class="op">(</span><span class="va">expr_mat</span>, <span class="va">sample_info</span>, <span class="va">var_info</span>, exp_type <span class="op">=</span> <span class="st">"glycomics"</span>, glycan_type <span class="op">=</span> <span class="st">"N"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Column <span style="color: #00BB00;">group</span> converted to <span style="color: #0000BB;">&lt;factor&gt;</span>.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Glycomics Experiment</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Expression matrix: <span style="color: #0000BB;">3</span> samples, <span style="color: #0000BB;">3</span> variables</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Sample information fields: <span style="color: #00BB00;">group</span> <span style="color: #0000BB;">&lt;fct&gt;</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Variable information fields: <span style="color: #00BB00;">glycan_composition</span> <span style="color: #0000BB;">&lt;comp&gt;</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bin Fu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

